---
title: Usage tracking error codes Azure Stack | Microsoft Docs
description: Type the description in Azure Stack.
services: azure-stack
documentationcenter: ''
author: mattbriggs
manager: femila
editor: ''

ms.service: azure-stack
ms.workload: na
pms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 02/05/2018
ms.author: mabrigg
ms.reviewer: alfredo

---

# Usage tracking error codes Azure Stack

*Applies to: Azure Stack integrated systems*

## Error Codes

The following error messages can be encountered when adding tenants to a registration.

| Error                           | Details                                                                                                                                                                                                                                                                                                                           | Comments                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|---------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| RegistrationNotFound            | The provided registration was not found. Make sure the following information was provided correctly:<br>1. Subscription Identifier (value provided: _subscription identifier_),<br>2. Resource Group (value provided: _resource group_),<br>3. Registration Name (value provided: _registration name_).                             | This error usually occurs when the information pointing to the initial registration is not correct. If you need to verify the resource group and name of your registration, you can find it in the Azure portal, by listing all resources. If you find more than one registration resource, look at the CloudDeploymentID in the properties, and select the registration whose CloudDeploymentID matches that of your cloud. To find the CloudDeploymentID, you can use this PowerShell on the Azure Stack:<br>`$azureStackStampInfo = Invoke-Command -Session $session -ScriptBlock { Get-AzureStackStampInformation }` |
| BadCustomerSubscriptionId       | The provided _customer subscription identifier_ and the _registration name_ Subscription Identifier are not owned by the same Microsoft Cloud Service Provider. Check that the Customer Subscription Identifier is correct. If the problem persists, contact support. | This error occurs when the customer subscription is a CSP subscription, but it rolls up to a CSP partner different from the one to which the subscription used in the initial registration rolls up. This check is made to prevent a situation that would result in billing a CSP partner who is not responsible for the Azure Stack used.                                                                                                                                                                                                                                                                          |
| InvalidCustomerSubscriptionId   | The '_customer subscription identifier_' is not valid. Make sure a valid Azure subscription is provided.                                                                                                                                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| CustomerSubscriptionNotFound    | _Customer subscription identifier_ was not found under _registration name. Make sure a valid Azure subscription is being used and that the Subscription Identifier was added to the registration using the PUT operation.                                                   | This error occurs when trying to verity that a tenant has been added to a subscription, and the customer subscription is not found to be associated with the registration. The customer has not been added to the registration, or the subscription ID has been written incorrectly.                                                                                                                                                                                                                                                                                                                                |
| UnauthorizedCspRegistration     | The provided _registration name_ is not approved to use multi-tenancy. Send an email to azstCSP@microsoft.com and include your registration name, resource group, and the subscription identifier used in the registration.                                                                                    | A registration needs to be approved for multi-tenancy by Microsoft before you can start adding tenants to it. Refer to the section Registering Tenants in this document for further explanation.                                                                                                                                                                                                                                                                                                                                                                                                             |
| CustomerSubscriptionsNotAllowed | Customer Subscriptions operations are not supported for disconnected customers. In order to use this feature, re-register with Pay As You Use licensing.                                                                                                                                                                    | The registration to which you are trying to add tenants is a Capacity registration, that is, when the registration was created, the parameter BillingModel Capacity was used. Only Pay as you use registrations are allowed for to add tenants. You need to re-register using the parameter BillingModel PayAsYouUse.                                                                                                                                                                                                                                                                                          |
| InvalidCSPSubscription          | The provided _customer subscription identifier_ is not a valid CSP subscription. Make sure a valid Azure subscription is provided.                                                                                                                                                        | This is mostly likely to be due to the customer subscription being mistyped.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| MetadataResolverBadGatewayError | One of the upstream servers returned an unexpected error. Try again later. If the problem persists, Contact support.                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |


## Next steps

 - To learn more about how to retrieve resource usage information from Azure Stack, see [Usage and billing in Azure Stack](/azure-stack-billing-and-chargeback.md).
